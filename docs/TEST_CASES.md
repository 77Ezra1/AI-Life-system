# Personal Chatbox - 测试用例

## 测试环境准备

### 1. 应用优化

```bash
cd Personal-Chatbox
./scripts/apply-optimizations.sh
```

### 2. 启动开发服务器

```bash
npm run dev
```

### 3. 启动后端服务器

```bash
npm run server
```

---

## 测试用例清单

### 一、Markdown渲染测试

#### 1.1 代码块语法高亮

**测试步骤**:
1. 创建新对话
2. 输入以下内容:

````
请帮我展示Python代码:

```python
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

# 测试
for i in range(10):
    print(f"fibonacci({i}) = {fibonacci(i)}")
```

再展示JavaScript代码:

```javascript
const factorial = (n) => {
  if (n <= 1) return 1
  return n * factorial(n - 1)
}

// 测试
for (let i = 0; i < 10; i++) {
  console.log(`factorial(${i}) = ${factorial(i)}`)
}
```
````

**预期结果**:
- ✅ Python代码有语法高亮(关键字、字符串、注释等不同颜色)
- ✅ JavaScript代码有语法高亮
- ✅ 代码块有复制按钮
- ✅ 显示语言标签(Python/JavaScript)

**实际结果**: ___________

---

#### 1.2 表格渲染

**测试步骤**:
1. 输入以下Markdown表格:

```markdown
请展示这个表格:

| 功能 | 状态 | 优先级 | 完成度 |
|------|------|--------|--------|
| 代码高亮 | ✅ 完成 | 高 | 100% |
| 表格美化 | ✅ 完成 | 高 | 100% |
| LaTeX支持 | ✅ 完成 | 中 | 100% |
| 性能优化 | 🔄 进行中 | 高 | 80% |
| 深色模式 | ✅ 完成 | 中 | 100% |
```

**预期结果**:
- ✅ 表格渲染美观
- ✅ 表头有背景色
- ✅ 奇偶行有斑马纹
- ✅ 鼠标悬停有高亮效果
- ✅ 表格边框清晰
- ✅ 响应式(窗口缩小时可横向滚动)

**实际结果**: ___________

---

#### 1.3 LaTeX公式

**测试步骤**:
1. 输入以下内容:

```markdown
请展示数学公式:

行内公式: 爱因斯坦质能方程 $E = mc^2$

块级公式:

$$
\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
$$

更复杂的公式:

$$
\frac{-b \pm \sqrt{b^2 - 4ac}}{2a}
$$

矩阵:

$$
\begin{bmatrix}
a & b \\
c & d
\end{bmatrix}
$$
```

**预期结果**:
- ✅ 行内公式正确渲染
- ✅ 块级公式居中显示
- ✅ 公式符号清晰
- ✅ 分数、根号、积分符号正确
- ✅ 矩阵格式正确

**实际结果**: ___________

---

#### 1.4 引用块

**测试步骤**:
1. 输入:

```markdown
> 这是一段引用文字
> 支持多行引用
> 
> 可以包含**粗体**和*斜体*
```

**预期结果**:
- ✅ 引用块有左边框
- ✅ 背景色与主题协调
- ✅ 内部格式正常(粗体、斜体)

**实际结果**: ___________

---

#### 1.5 列表

**测试步骤**:
1. 输入:

```markdown
无序列表:
- 项目1
- 项目2
  - 嵌套项2.1
  - 嵌套项2.2
- 项目3

有序列表:
1. 第一步
2. 第二步
3. 第三步
```

**预期结果**:
- ✅ 列表缩进正确
- ✅ 嵌套层级清晰
- ✅ 列表符号/数字显示正常

**实际结果**: ___________

---

#### 1.6 链接

**测试步骤**:
1. 输入:

```markdown
访问 [GitHub](https://github.com) 和 [Google](https://google.com)
```

**预期结果**:
- ✅ 链接有下划线
- ✅ 链接颜色醒目
- ✅ 点击可打开新标签页
- ✅ 访问后颜色变化

**实际结果**: ___________

---

#### 1.7 图片

**测试步骤**:
1. 输入包含图片的Markdown:

```markdown
![测试图片](https://via.placeholder.com/400x300)
```

**预期结果**:
- ✅ 图片正常显示
- ✅ 图片有圆角
- ✅ 图片懒加载(滚动时才加载)
- ✅ 图片响应式(不超出容器)

**实际结果**: ___________

---

### 二、深色模式测试

#### 2.1 主题切换

**测试步骤**:
1. 点击设置
2. 切换到深色模式
3. 观察所有组件

**预期结果**:
- ✅ 切换平滑无闪烁
- ✅ 所有文字可读
- ✅ 对比度适中
- ✅ 无刺眼的白色

**实际结果**: ___________

---

#### 2.2 深色模式代码块

**测试步骤**:
1. 切换到深色模式
2. 查看之前创建的代码块

**预期结果**:
- ✅ 代码块背景色深色
- ✅ 代码文字清晰可读
- ✅ 语法高亮颜色协调
- ✅ 工具栏背景色更深
- ✅ 复制按钮可见

**实际结果**: ___________

---

#### 2.3 深色模式表格

**测试步骤**:
1. 在深色模式下查看表格

**预期结果**:
- ✅ 表格边框可见
- ✅ 表头背景色适中
- ✅ 斑马纹清晰
- ✅ 悬停效果明显
- ✅ 文字对比度好

**实际结果**: ___________

---

#### 2.4 深色模式LaTeX

**测试步骤**:
1. 在深色模式下查看LaTeX公式

**预期结果**:
- ✅ 公式符号清晰
- ✅ 颜色与背景对比度好
- ✅ 无白色背景

**实际结果**: ___________

---

#### 2.5 深色模式引用块

**测试步骤**:
1. 在深色模式下查看引用块

**预期结果**:
- ✅ 左边框颜色醒目
- ✅ 背景色与主题协调
- ✅ 文字清晰

**实际结果**: ___________

---

#### 2.6 深色模式思考过程框

**测试步骤**:
1. 启用深度思考模式
2. 发送消息
3. 查看思考过程框

**预期结果**:
- ✅ 折叠框背景色适中
- ✅ 按钮可见
- ✅ 展开内容清晰
- ✅ 边框颜色协调

**实际结果**: ___________

---

### 三、性能测试

#### 3.1 长对话滚动

**测试步骤**:
1. 创建包含50+条消息的对话
2. 快速滚动

**预期结果**:
- ✅ 滚动流畅,无卡顿
- ✅ 消息渲染快速
- ✅ 无明显延迟

**实际结果**: ___________

---

#### 3.2 复杂Markdown渲染

**测试步骤**:
1. 输入包含多个代码块、表格、公式的长消息
2. 观察渲染速度

**预期结果**:
- ✅ 渲染速度快(<1秒)
- ✅ 无界面冻结
- ✅ 流式输出流畅

**实际结果**: ___________

---

#### 3.3 图片懒加载

**测试步骤**:
1. 输入包含多张图片的消息
2. 观察加载行为

**预期结果**:
- ✅ 图片按需加载
- ✅ 滚动到可见区域才加载
- ✅ 不阻塞其他内容

**实际结果**: ___________

---

#### 3.4 内存使用

**测试步骤**:
1. 打开浏览器开发者工具
2. 查看Performance/Memory标签
3. 创建长对话并观察

**预期结果**:
- ✅ 内存增长合理
- ✅ 无明显内存泄漏
- ✅ GC正常工作

**实际结果**: ___________

---

### 四、兼容性测试

#### 4.1 现有对话

**测试步骤**:
1. 打开优化前创建的对话
2. 检查显示是否正常

**预期结果**:
- ✅ 所有消息正常显示
- ✅ 格式无变化
- ✅ 功能正常

**实际结果**: ___________

---

#### 4.2 MCP工具调用

**测试步骤**:
1. 启用MCP服务
2. 发送需要工具调用的消息
3. 查看工具调用显示

**预期结果**:
- ✅ 思考过程正常折叠
- ✅ 工具调用内容显示正确
- ✅ 结果正常显示

**实际结果**: ___________

---

#### 4.3 深度思考模式

**测试步骤**:
1. 启用深度思考
2. 发送复杂问题
3. 查看思考过程

**预期结果**:
- ✅ 思考过程框正常
- ✅ 内容格式正确
- ✅ 折叠/展开正常

**实际结果**: ___________

---

#### 4.4 文件附件

**测试步骤**:
1. 上传文件
2. 发送消息
3. 查看显示

**预期结果**:
- ✅ 附件显示正常
- ✅ 不影响Markdown渲染

**实际结果**: ___________

---

#### 4.5 设置项

**测试步骤**:
1. 打开设置
2. 检查所有选项

**预期结果**:
- ✅ 所有设置项正常
- ✅ 主题切换正常
- ✅ 模型配置正常
- ✅ MCP配置正常

**实际结果**: ___________

---

### 五、回归测试

#### 5.1 基本功能

**测试步骤**:
1. 测试所有基本功能

**检查项**:
- [ ] 新建对话
- [ ] 发送消息
- [ ] 接收回复
- [ ] 编辑消息
- [ ] 删除消息
- [ ] 删除对话
- [ ] 搜索对话
- [ ] 切换模型
- [ ] 调整参数

**实际结果**: ___________

---

#### 5.2 UI布局

**测试步骤**:
1. 检查UI布局是否有变化

**检查项**:
- [ ] 侧边栏正常
- [ ] 聊天区域正常
- [ ] 输入框正常
- [ ] 按钮位置正常
- [ ] 响应式布局正常

**实际结果**: ___________

---

## 测试总结

### 通过的测试

- [ ] Markdown渲染 (___/7)
- [ ] 深色模式 (___/6)
- [ ] 性能 (___/4)
- [ ] 兼容性 (___/5)
- [ ] 回归测试 (___/2)

### 发现的问题

1. ___________
2. ___________
3. ___________

### 建议

1. ___________
2. ___________
3. ___________

### 测试结论

- [ ] ✅ 通过,可以交付
- [ ] ⚠️ 有小问题,需要修复
- [ ] ❌ 有严重问题,需要回滚

---

## 测试签名

测试人员: ___________
测试日期: ___________
测试环境: ___________

